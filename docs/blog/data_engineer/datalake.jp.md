データ分析基盤の 3 層構造
データ分析基盤とは、ビッグデータを統合して活用するためのシステムです。一般的にはデータレイク、データウェアハウス、データマートの 3 層構造がシステム構成として採用されることが多いです。

データレイク層（DL）
データレイクとは、様々なデータソースから構造化データ（テーブルデータなど）、非構造化データ（画像、音声、動画データやアプリケーションのログなど）、半構造化データ（JSON、CSV など）を加工せずそのままの状態で保存する場所です。データの中身に誤りがあったとしても修正せずにそのままの状態で集約します。 データ構造やスキーマはデータ保存時では定義されないため、構造化の手間をかけずにデータを格納できます。現時点でデータの用途が定まっていない場合でもデータレイクに蓄積していきます。

加工せずに生データを蓄積する理由
データを加工してデータレイクに保存すると、分析の柔軟性が失われてしまいます。例えば、月集計してデータをデータレイクに蓄えていくと、日集計での分析が困難になります。また、データレイクに取り込まれるデータに問題が発生した場合、元データに問題があるのか加工に問題があるのかの原因調査が困難になります。 他には，加工に失敗してデータを損失する可能性もあります。例外として、生データに個人情報が含まれているなど場合では加工するケースもあります。

データを一箇所に集約する理由
データを集約することで全社を横断してデータを活用することができます。対してデータの場所が分散していると（例えば、営業部門とマーケティング部門が別々でデータを管理しているなど）、データの場所を探したり、それぞれのデータにアクセスするための申請などが必要になり、アジリティが欠けてしまいます。

データレイク層に適したクラウドサービス
データレイク層としてよく採用されるクラウドサービスとして AWS の Amazon S3 や GCP の Cloud Storage などが挙げられます。これらのサービスは冗長性と拡張性に優れたオブジェクトストレージであり、データの形式を問わずあらゆるデータを格納することができます。

データウェアハウス層（DWH）
データウェアハウスとは、複数のシステムから構造化データを全社的に統合して、データ分析をするための保存場所です。大量に蓄積したデータを分析することにより、ビジネスにおけるインサイトを得て組織の意思決定をサポートするために用いられます。データウェアハウス層を構築するうえで、共通指標を意識する必要があります。例えば、店舗と EC サイトで商品を販売している場合、店舗と EC サイトで通貨の違いや消費税の有無など「売上」の定義が異なる可能性があります。データウェアハウスで「売上」という共通指標の定義をしてデータの信頼性を向上させます。このように、全社横断のデータ活用を進めるため、信頼できる唯一の情報を一箇所で定めておく必要があります。

データレイク層との違い
データの集約という観点ではデータレイクと共通していますが、データウェアハウスは「データ分析」という明確な目的がある一方、データレイクは目的が定まっていないデータも存在します。また、データウェアハウス層では非構造化データを格納することはできません。他には、データレイク層では生データが保管されますが、 データウェアハウス層では分析可能な状態にするためデータを加工・整理したうえで保管されます。

一般的なデータベースとの違い
データウェアハウスは一般的なデータベースと比較し、保存データ容量が大きいたため、古くなったデータを定期的に削除する必要がありません。そのため、データウェアハウスでは長期間にわたるデータ分析や多様な観点からのデータ分析を行うことが可能になります。また、データウェアハウスはデータベースの列方向の処理に特化したカラム型データベースであるため、大量のデータを高速に参照したり集計することが可能になります。

データウェアハウス層に適したクラウドサービス
データウェアハウス層としてよく採用されるクラウドサービスとして AWS の Amazon Redshift や GCP の BigQuery などが挙げられます。これらのサービスは大容量のデータが保存可能であり、非常に高速に集計が可能です。また、データソースが CSV や JSON 形式のデータの場合は Amazon S3 や Google Cloud Storage などのオブジェクトストレージを使用せず、Redshift や BigQuery などのデータウェアハウス製品に直接蓄えることも可能です。この場合はデータウェアハウス内でデータレイク層とデータウェアハウス層に分けます。

データマート層（DM）
データマートとは、データウェアハウスのサブセットであり、データウェアハウスを細分化して特定の目的に使用するデータのみを抽出して格納されたデータベースです。例えば、データウェアハウス層にある「取引履歴」データをもとに「毎週の取引回数」といった集計データをデータマートに格納します。まだデータウェアハウス層に関する業務知識が体系化されていない場合は、まずはデータレイク層を参照してデータマート層を構築していきます。データマート層が充実するにつれて同様の集計が重複するようになり、データウェアハウス層の「共通指標」が見えてきた段階でデータウェアハウス層を構築していきます。

データマートを構築する理由
データマートを構築して特定の用途ごとにデータを管理することにより以下のメリットが得られます。

影響範囲を制限
他用途への影響を気にしなくて良いため、集計ロジックを自由に更新することができます。
SQL の応答時間の向上
フルスキャンされても困らない程度のデータ量に削減されるため、BI ツールでの測定やレポーティングがスムーズになります。
必要なデータの探索時間の減少
巨大なデータウェアハウスからデータを探索せずに、すぐに必要なデータにアクセスすることができます。
データ分析基盤の目的意識を持つ
データレイク、データウェアハウス、データマートを考える前にまずはデータ分析基盤によって実現したいことを整理します。例えば EC サイトの場合は以下のような用途が考えられます。

売上、在庫などのモニタリング
顧客のレビューの傾向分析
広告の便益測定
この他にも無数の用途が考えられます。データ分析基盤の目的意識をしっかり持って、誰にも使われないデータ分析基盤の構築を回避しましょう。

参考
データウェアハウス、データマート、データレイクの特徴とは
データレイクとデータウェアハウスの違いとは
データ基盤の 3 分類と進化的データモデリング
データ分析基盤の基本と構築のポイント
DWH で解決できる課題と導入メリットとは？
データウェアハウス（DWH）とは？目的や特徴を分かりやすく解説
データレイク、データウェアハウス、データマートって結局なんなん？
実践的データ基盤への処方箋〜 ビジネス価値創出のためのデータ・システム・ヒトのノウハウ
ビッグデータを支える技術 ——ラップトップ 1 台で学ぶデータ基盤のしくみ
